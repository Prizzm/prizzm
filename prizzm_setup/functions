# /* vim: set filetype=sh : */   
#
## Heroku command shortcuts
# Taken from comments here:
# http://jqr.github.com/2010/08/27/easy-heroku-deploys-with-heroku-san.html
#
# Example usage:
#
#     development db:push
#
#     Pushes the local db to the development server
 
 
function deploy() {
  server=${1:=development}

  echo "${alert} Compiling css with 'compass compile .'${txtrst}..."
  compass compile .
  
  echo "${alert} Packaging assets with 'jammit'${txtrst}..."
  jammit  

  # Need to add line to remove these commits from history..using autosquash
  git add public/assets
  git commit -m "Deploment - predeploy script${txtrst}..."
 
  echo "${alert} Deploying code to heroku${txtrst}..."
  rake $server deploy  && git push origin master
  
  echo "${bldylw} Don't forget to push your changes to github! ${alert}'git push origin master'${txtrst}"
}
alias dep='deploy'

function staging() { heroku $@ --app $(basename `pwd`)-staging ;}
function production() { heroku $@ --app $(basename `pwd`)-production ;}
function demo() { heroku $@ --app $(basename `pwd`)-demo ;}
function development() { heroku $@ --app $(basename `pwd`)-development ;}
alias stage='staging'
alias dev='development'
alias prod='production'


function find_and_replace  {
# Usage: find_and_replace $target $replacement
#
# Recursively search the files in the child directories for the target string,
# and replace the target string in place with replacement
#
# Improvements:  Could pass options to ack to improve filetypes searched

    target=$1
    replacement=$2
    ack -l $target | xargs -n 1 sed -i "s/$target/$replacement/g"
}




